# 执行上下文

```js
function fn() {
  console.log(a)  // undefined
  var a = 1
}
fn()
```

## 概念

  当代码运行时，会产生一个对应的执行环境，在这个环境中，所有变量会被事先提出来（变量提升），有的直接赋值，有的为默认值undefined，代码从上往下开始执行，叫做执行上下文。

## js的运行环境

  1、全局环境：代码首先进入全局环境
  2、函数环境：函数被调用时执行的环境
  3、eval函数

## 特点

1、单线程，在主线程执行
2、同步执行，从上往下按顺序执行
3、全局上下文只有一个，浏览器关闭时会被弹出栈
4、函数的执行上下文没有数目限制
5、函数每被调用一次，都会产生一个新的执行上下文环境

## 执行上下文栈

执行全局代码时，会产生一个执行上下文环境，每次调用函数都又会产生执行上下文环境。当函数调用完成时，这个上下文环境以及其中的数据都会被清除，再重新回到全局上下文环境。处于活动状态的执行上下文环境只有一个。
其实这是一个压栈和出栈的过程———执行上下文栈
![1600324163](./assets/image/1600324163(1).jpg)

```js
var                 // 进入全局上下文环境
    a =10,
    fn,
    bar = function(x) {
      var b = 20
      fn(x + b)     // 进入fn上下文环境
    }
fn = function(y) {
  var c = 20
  console.log(y + c)
}
bar(5);       // 进入bar上下文环境
```
![1600324519](./assets/image/1600324519(1).jpg)


## 执行上下文生命周期
![1600324625](./assets/image/1600324625(1).jpg)